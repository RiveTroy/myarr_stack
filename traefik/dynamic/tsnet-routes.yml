################################################################
# Tailscale ts.net Routes
# Valid SSL certificates for remote access
################################################################

http:
  routers:
    # Redirect arr.local → ts.net
    arr-local-redirect:
      rule: "HostRegexp(`{subdomain:[a-z0-9-]+}.arr.local`)"
      entrypoints:
        - websecure
      middlewares:
        - redirect-to-tailscale@file
      service: noop@internal
      tls: {}
      priority: 1  # Low priority - only if no other match

    # Authelia for ts.net
    authelia-tsnet:
      rule: "Host(`auth.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      service: authelia
      tls: {}

    # Radarr
    radarr-tsnet:
      rule: "Host(`radarr.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: radarr
      tls: {}

    # Sonarr
    sonarr-tsnet:
      rule: "Host(`sonarr.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: sonarr
      tls: {}

    # Prowlarr
    prowlarr-tsnet:
      rule: "Host(`prowlarr.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: prowlarr
      tls: {}

    # Lidarr
    lidarr-tsnet:
      rule: "Host(`lidarr.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: lidarr
      tls: {}

    # Bazarr
    bazarr-tsnet:
      rule: "Host(`bazarr.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: bazarr
      tls: {}

    # qBittorrent
    qbittorrent-tsnet:
      rule: "Host(`qbittorrent.your-hostname.ts.net`) || Host(`qbit.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: qbittorrent
      tls: {}

    # Jellyfin (no auth - has own auth)
    jellyfin-tsnet:
      rule: "Host(`jellyfin.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      service: jellyfin
      tls: {}

    # Jellyseerr
    jellyseerr-tsnet:
      rule: "Host(`jellyseerr.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: jellyseerr
      tls: {}

    # Homepage Dashboard
    dash-tsnet:
      rule: "Host(`dash.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: homepage
      tls: {}

    # Uptime Kuma
    uptime-tsnet:
      rule: "Host(`uptime.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: uptime-kuma
      tls: {}

    # Dozzle
    logs-tsnet:
      rule: "Host(`logs.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: dozzle
      tls: {}

    # Dockge - LOCAL ONLY (ts.net'ten erişilemez)

    # Komga
    komga-tsnet:
      rule: "Host(`komga.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: komga
      tls: {}

    # Ntfy
    notify-tsnet:
      rule: "Host(`notify.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      service: ntfy
      tls: {}

    # Autobrr
    autobrr-tsnet:
      rule: "Host(`autobrr.your-hostname.ts.net`)"
      entrypoints:
        - websecure
      middlewares:
        - auth-tsnet@file
      service: autobrr
      tls: {}

    # AdGuard - LOCAL ONLY (ts.net'ten erişilemez)

  services:
    # Services reference containers by name
    authelia:
      loadBalancer:
        servers:
          - url: "http://authelia:9091"
    radarr:
      loadBalancer:
        servers:
          - url: "http://radarr:7878"
    sonarr:
      loadBalancer:
        servers:
          - url: "http://sonarr:8989"
    prowlarr:
      loadBalancer:
        servers:
          - url: "http://prowlarr:9696"
    lidarr:
      loadBalancer:
        servers:
          - url: "http://lidarr:8686"
    bazarr:
      loadBalancer:
        servers:
          - url: "http://bazarr:6767"
    qbittorrent:
      loadBalancer:
        servers:
          - url: "http://gluetun:8085"
    jellyfin:
      loadBalancer:
        servers:
          - url: "http://jellyfin:8096"
    jellyseerr:
      loadBalancer:
        servers:
          - url: "http://jellyseerr:5055"
    homepage:
      loadBalancer:
        servers:
          - url: "http://homepage:3000"
    uptime-kuma:
      loadBalancer:
        servers:
          - url: "http://uptime-kuma:3001"
    dozzle:
      loadBalancer:
        servers:
          - url: "http://dozzle:8080"
    dockge:
      loadBalancer:
        servers:
          - url: "http://dockge:5001"
    komga:
      loadBalancer:
        servers:
          - url: "http://komga:25600"
    ntfy:
      loadBalancer:
        servers:
          - url: "http://ntfy:80"
    autobrr:
      loadBalancer:
        servers:
          - url: "http://autobrr:7474"
    adguard:
      loadBalancer:
        servers:
          - url: "http://adguardhome:80"
